"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[76767],{1552:(e,r,t)=>{t.d(r,{$:()=>u,r:()=>d});var n=t(31768),a=t(27252),s=t(26766),i=t(47864),o=t(58799),l=t(56881);let d=(0,i.F)("inline-flex cursor-pointer items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-[color,box-shadow] disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-hidden focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-2xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-2xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40",outline:"border border-input bg-background shadow-2xs hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-2xs hover:bg-secondary/80",soft:"bg-secondary text-secondary-foreground shadow-2xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",glass:"bg-white/30 text-white shadow-2xs hover:bg-white/40 backdrop-blur-lg border border-white/20"},size:{default:"h-10 px-4 py-2",xs:"h-8 rounded-md px-2",sm:"h-9 rounded-md px-3",md:"h-10 rounded-md px-4",lg:"h-11 rounded-md px-8",icon:"h-10 w-10","icon-sm":"h-8 w-8","icon-xs":"h-6 w-6"},rounded:{full:"rounded-full"}},defaultVariants:{variant:"default",size:"default"}}),u=a.forwardRef((e,r)=>{let{className:t,variant:a,size:i,rounded:u,asChild:c=!1,loading:f,children:g,...p}=e,m=c?s.DX:"button",h=(0,n.jsxs)(n.Fragment,{children:[f&&(0,n.jsx)(l.Icon,{icon:"mdi:loading",className:"animate-spin mr-2 h-4 w-4"}),g]});return(0,n.jsx)(m,{disabled:p.disabled||f,"data-slot":"button",className:(0,o.cn)(d({variant:a,size:i,rounded:u,className:t})),ref:r,...p,children:c?(0,n.jsx)("span",{children:h}):h})});u.displayName="Button"},7068:(e,r,t)=>{t.d(r,{p:()=>d});var n=t(31768),a=t(27252),s=t(58799),i=t(56881),o=t(30331);function l(e,r){return e?"string"==typeof e?(0,n.jsx)(i.Icon,{icon:e,className:(0,s.cn)("h-4 w-4 text-muted-foreground",r)}):(0,n.jsx)(e,{className:(0,s.cn)("h-4 w-4 text-muted-foreground",r)}):null}let d=a.forwardRef((e,r)=>{let{className:t,type:i,removeWrapper:d=!1,error:u=!1,errorMessage:c,icon:f,iconClassName:g,iconPosition:p="left",title:m,label:h,description:v,validationRules:y,validateOnChange:b=!1,prefix:x,postfix:w,hasRing:L=!0,hasShadow:k=!0,...j}=e,[E,S]=a.useState(""),N=u||!!E,K=c||E,A=e=>{if(!y)return;let r=(0,o.q)(e,y);return S(r.isValid?"":r.message),r.isValid},q=(0,s.cn)("border-input placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base transition-[color,box-shadow] outline-hidden disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive flex items-center",L?"focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]":"focus-visible:outline-none focus-visible:border-input",k?"shadow-sm":"",N&&"border-2 border-red-500 focus:ring-red-500 focus:ring-2",t),R=f&&"left"===p?l(f,g):null,T=f&&"right"===p?l(f,g):null,P=(0,n.jsxs)("div",{className:q,children:[x&&(0,n.jsx)("div",{className:"mr-2 flex-shrink-0",children:x}),R&&(0,n.jsx)("div",{className:"mr-2 pointer-events-none flex-shrink-0",children:R}),(0,n.jsx)("input",{ref:r,type:i,"data-slot":"input",className:"flex-1 bg-transparent border-none p-0 m-0 focus:outline-none focus:ring-0",onBlur:e=>{y&&A(e.target.value),j.onBlur&&j.onBlur(e)},onChange:e=>{y&&b&&A(e.target.value),j.onChange&&j.onChange(e)},...j}),T&&(0,n.jsx)("div",{className:"ml-2 pointer-events-none flex-shrink-0",children:T}),w&&(0,n.jsx)("div",{className:"ml-2 flex-shrink-0",children:w})]}),z=(0,n.jsxs)(n.Fragment,{children:[(m||h)&&(0,n.jsx)("label",{className:"mb-1 text-sm font-medium text-gray-700 dark:text-gray-200",children:m||h}),P,v&&(0,n.jsx)("p",{className:"mt-1 text-xs text-muted-foreground",children:v}),N&&K&&(0,n.jsx)("p",{className:"text-red-500 text-sm mt-1 leading-normal",children:K})]});return d?z:(0,n.jsx)("div",{className:"flex-1 w-full flex flex-col",children:z})});d.displayName="Input"},8142:(e,r,t)=>{t.d(r,{Ay:()=>o,xq:()=>a});var n=t(34369);async function a(e){let{url:r,method:t="GET",body:a=null,headers:o={},params:l={},successMessage:d="Success",errorMessage:u="Something went wrong",silent:c=!1,silentSuccess:f=!1}=e,g=c?null:n.oR.loading("Loading..."),p={"Content-Type":"application/json",...o},m=r;try{let e=r.startsWith("http")?r:"".concat("https://mash3div.com").concat(r);if(Object.keys(l).length>0){let r=new URL(e);Object.entries(l).forEach(e=>{let[t,n]=e;r.searchParams.set(t,String(n))}),m=r.toString()}else m=e;let o={method:t,headers:p,credentials:"include",body:a?JSON.stringify(a):null},h=await fetch(m,o);c||null===g||n.oR.dismiss(g);let v=null;try{let e=await h.text();if(e)try{v=JSON.parse(e)}catch(e){return console.warn("Failed to parse response as JSON:",e),c||null===g||n.oR.dismiss(g),c||n.oR.error(u),{data:null,error:"Invalid response format"}}else{if(!h.ok)return c||null===g||n.oR.dismiss(g),c||n.oR.error(u),{data:null,error:"Request failed with status ".concat(h.status)};return{data:null,error:null}}}catch(e){return console.warn("Failed to read response:",e),c||null===g||n.oR.dismiss(g),c||n.oR.error(u),{data:null,error:"Failed to read response"}}if(!h.ok)return await s(h,v,c,u);if(v&&"object"==typeof v){let e=v;if(e.statusCode&&e.statusCode>=400||!1===e.success||e.error||e.errors)return function(e,r,t){let a=e.message||t,s=i(a);return s?(r||n.oR.error("Validation error"),{data:null,error:"Validation error",validationErrors:s}):(r||n.oR.error(a),{data:null,error:a})}(e,c,u)}return function(e,r,t,a){if(t||a)return;let s="Success";"Success"===(s="function"==typeof r?r(e):r)&&e&&"object"==typeof e&&e.message&&(s=e.message),n.oR.success(s)}(v,d,c,f),{data:v,error:null}}catch(e){var h=e,v=c,y=g;if(console.error("Fetch error:",h),!v){null!==y&&n.oR.dismiss(y);let e=h instanceof Error?h.message:"Unknown error";n.oR.error("Network error: ".concat(e,". Please try again later."))}return{data:null,error:h instanceof Error?h.message:"Unknown error"}}}async function s(e,r,t,a){if(r&&"object"==typeof r&&r.statusCode){let e=r.message||a,s=i(e);return s?(t||n.oR.error("Validation error"),{data:null,error:"Validation error",validationErrors:s}):(t||n.oR.error(e),{data:null,error:e})}let s=r&&r.message||e.statusText||a,o=i(s);return o?(t||n.oR.error("Validation error"),{data:null,error:"Validation error",validationErrors:o}):(t||n.oR.error(s),{data:null,error:s})}function i(e){if(!e)return null;if(e.startsWith("Invalid request body:")){let t=e.replace("Invalid request body:","").trim();try{var r=JSON.parse(t);let e={};return Object.entries(r).forEach(r=>{let[t,n]=r,a=t.split(".");a.reduce((e,r,t)=>(t===a.length-1?e[r]=Array.isArray(n)?n[0]:n:e[r]=e[r]||{},e[r]),e)}),e}catch(e){return null}}return e.includes("Validation error:")?function(e){let r=e.split("\n"),t={};return r.forEach(e=>{let r=e.replace("Validation error: ",""),n=r.indexOf(":");if(-1!==n){let e=r.substring(0,n).trim(),a=r.substring(n+1).trim();t[e]=a}}),t}(e):null}let o=a},30331:(e,r,t)=>{function n(e,r){for(let t of r)if(!t.validate(e))return{isValid:!1,message:t.message};return{isValid:!0,message:""}}t.d(r,{q:()=>n,t:()=>a});let a={required:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"This field is required";return{validate:e=>null!=e&&("string"==typeof e?e.trim().length>0:"number"==typeof e||(Array.isArray(e)?e.length>0:!!e)),message:e}},minLength:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Must be at least ".concat(e," characters");return{validate:r=>"string"!=typeof r||r.length>=e,message:r}},maxLength:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Must be no more than ".concat(e," characters");return{validate:r=>"string"!=typeof r||r.length<=e,message:r}},email:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Please enter a valid email address";return{validate:e=>"string"!=typeof e||!e||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),message:e}},numeric:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Must be a number";return{validate:e=>""===e||null==e||!isNaN(Number(e)),message:e}},min:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Must be at least ".concat(e);return{validate:r=>""===r||null==r||Number(r)>=e,message:r}},max:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Must be no more than ".concat(e);return{validate:r=>""===r||null==r||Number(r)<=e,message:r}},pattern:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Invalid format";return{validate:r=>"string"!=typeof r||!r||e.test(r),message:r}},custom:(e,r)=>({validate:e,message:r})}},41258:(e,r,t)=>{t.d(r,{U:()=>a});var n=t(27252);function a(e){let[r,t]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let n=window.matchMedia(e);n.matches!==r&&t(n.matches);let a=()=>t(n.matches);return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[r,e]),r}},52893:(e,r,t)=>{t.d(r,{Hr:()=>p,Ht:()=>m,I:()=>c,SQ:()=>u,_2:()=>f,hO:()=>g,lp:()=>h,mB:()=>v,rI:()=>l,ty:()=>d});var n=t(31768);t(27252);var a=t(53542),s=t(13785),i=t(52487),o=t(58799);function l(e){let{...r}=e;return(0,n.jsx)(a.bL,{"data-slot":"dropdown-menu",...r})}function d(e){let{...r}=e;return(0,n.jsx)(a.l9,{"data-slot":"dropdown-menu-trigger",...r})}function u(e){let{className:r,sideOffset:t=4,...s}=e;return(0,n.jsx)(a.ZL,{children:(0,n.jsx)(a.UC,{"data-slot":"dropdown-menu-content",sideOffset:t,className:(0,o.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",r),...s})})}function c(e){let{...r}=e;return(0,n.jsx)(a.YJ,{"data-slot":"dropdown-menu-group",...r})}function f(e){let{className:r,inset:t,variant:s="default",...i}=e;return(0,n.jsx)(a.q7,{"data-slot":"dropdown-menu-item","data-inset":t,"data-variant":s,className:(0,o.cn)("focus:bg-accent cursor-pointer focus:text-accent-foreground data-[variant=destructive]:text-destructive-foreground data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/40 data-[variant=destructive]:focus:text-destructive-foreground [svg]:*:data-[variant=destructive]:text-destructive-foreground! [&_svg:not([class*='text-'])]:text-muted-foreground relative flex items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-disabled:pointer-events-none data-disabled:opacity-50 data-inset:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 hover:bg-accent hover:text-accent-foreground",r),...i})}function g(e){let{className:r,children:t,checked:i,...l}=e;return(0,n.jsxs)(a.H_,{"data-slot":"dropdown-menu-checkbox-item",className:(0,o.cn)("focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-disabled:pointer-events-none data-disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",r),checked:i,...l,children:[(0,n.jsx)("span",{className:"pointer-events-none absolute left-2 flex size-3.5 items-center justify-center",children:(0,n.jsx)(a.VF,{children:(0,n.jsx)(s.A,{className:"size-4"})})}),t]})}function p(e){let{...r}=e;return(0,n.jsx)(a.z6,{"data-slot":"dropdown-menu-radio-group",...r})}function m(e){let{className:r,children:t,...s}=e;return(0,n.jsxs)(a.hN,{"data-slot":"dropdown-menu-radio-item",className:(0,o.cn)("focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-disabled:pointer-events-none data-disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",r),...s,children:[(0,n.jsx)("span",{className:"pointer-events-none absolute left-2 flex size-3.5 items-center justify-center",children:(0,n.jsx)(a.VF,{children:(0,n.jsx)(i.A,{className:"size-2 fill-current"})})}),t]})}function h(e){let{className:r,inset:t,...s}=e;return(0,n.jsx)(a.JU,{"data-slot":"dropdown-menu-label","data-inset":t,className:(0,o.cn)("px-2 py-1.5 text-sm font-medium data-inset:pl-8",r),...s})}function v(e){let{className:r,...t}=e;return(0,n.jsx)(a.wv,{"data-slot":"dropdown-menu-separator",className:(0,o.cn)("bg-border -mx-1 my-1 h-px",r),...t})}},58799:(e,r,t)=>{t.d(r,{Yq:()=>o,bO:()=>l,cn:()=>s,vv:()=>d,zw:()=>i});var n=t(47014),a=t(4247);function s(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,a.QP)((0,n.$)(r))}function i(e,r){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t?r===e||r.startsWith(e+"/"):r===e}function o(e){return("string"==typeof e?new Date(e):e).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}function l(e){for(let r of["en","bn","ar"])if(e.startsWith("/".concat(r,"/")))return"/".concat(e.slice(r.length+2));return e}let d=(e,r)=>new Intl.NumberFormat("en-US",{style:"currency",currency:r}).format(e)},82415:(e,r,t)=>{t.d(r,{N_:()=>o,a8:()=>l,rd:()=>d});var n=t(49276),a=t(97631);let s="af, sq, am, ar, hy, as, az, bn, bs, bg, yue, ca, hr, cs, da, dv, nl, en, et, fj, fil, fi, fr, gl, ka, de, el, gu, ht, hi, hu, is, id, ga, it, ja, kn, kk, km, ko, lv, lt, mk, ms, ml, mt, mr, nb, fa, pl, pt, pa, ro, ru, sk, sl, es, sw, sv, ta, te, th, tr, uk, ur, vi, cy, zu".split(/[,\n\r]+/).map(e=>e.trim()).filter(e=>e.length>0)||["en","ar"],i=(0,a.o)({locales:s,defaultLocale:"en"}),{Link:o,usePathname:l,useRouter:d,redirect:u}=(0,n.xp)(i)},90833:(e,r,t)=>{t.d(r,{E:()=>l});var n=t(31768);t(27252);var a=t(26766),s=t(47864),i=t(58799);let o=(0,s.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",soft:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground",success:"border-transparent bg-success text-success-foreground [a&]:hover:bg-success/90"}},defaultVariants:{variant:"default"}}),l=e=>{let{className:r,variant:t,asChild:s=!1,...l}=e,d=s?a.DX:"span";return(0,n.jsx)(d,{"data-slot":"badge",className:(0,i.cn)(o({variant:t}),r),...l})}},97400:(e,r,t)=>{t.d(r,{k:()=>o});var n=t(8142),a=t(21207);let s=e=>{var r;let t;return e?(t=30,(null==(r=e.twoFactor)?void 0:r.enabled)&&(t+=30),e.emailVerified&&(t+=20),e.phoneVerified&&(t+=20),t):0},i=e=>{var r;if(!e)return 0;let t=[e.firstName,e.lastName,e.email,e.phone,e.profile,null!==e.avatar&&"/user/placeholder.svg"!==e.avatar,e.emailVerified,e.phoneVerified,null==(r=e.twoFactor)?void 0:r.enabled,!!e.walletAddress],n=t.length;return Math.round(t.filter(Boolean).length/n*100)},o=(0,a.v)((e,r)=>{let t=e=>{let r=e.permissions,t=e.ipWhitelist;if("string"==typeof r)try{r=JSON.parse(r)}catch(e){r=r.split(",").map(e=>e.trim())}if(Array.isArray(r)||(r=[]),"string"==typeof t)try{t=JSON.parse(t)}catch(e){t=t.split(",").map(e=>e.trim())}return Array.isArray(t)||(t=[]),{...e,permissions:r,ipWhitelist:t}};return{user:null,apiKeys:[],apiPermissions:[{label:"Trade",value:"trade",description:"Allows placing orders and trading on the exchange."},{label:"Futures",value:"futures",description:"Allows trading in futures markets."},{label:"Deposit",value:"deposit",description:"Allows viewing deposit addresses and history."},{label:"Withdraw",value:"withdraw",description:"Allows withdrawals from the account."},{label:"Transfer",value:"transfer",description:"Allows transfers between your accounts."},{label:"Payment",value:"payment",description:"Allows creating and confirming payments."}],securityScore:0,profileCompletion:0,isLoading:!0,error:null,apiKeyLoading:!1,apiKeyError:null,activeTab:"dashboard",showTwoFactorSetup:!1,setUser:r=>e({user:r,isLoading:!1,error:null}),setActiveTab:r=>e({activeTab:r}),setShowTwoFactorSetup:r=>e({showTwoFactorSetup:r}),hasKyc:()=>{let{user:e}=r();return function(e){return!!(null==e?void 0:e.kyc)&&"APPROVED"===e.kyc.status}(e)},canAccessFeature:e=>{let{user:t}=r();return function(e,r){var t,n;if(!e)return!1;if(Array.isArray(e.featureAccess))return e.featureAccess.includes(r);if(null==(n=e.kyc)||null==(t=n.level)?void 0:t.features){let t=[];try{t=JSON.parse(e.kyc.level.features)}catch(e){}return t.includes(r)}return!1}(t,e)},logout:async()=>{let{data:r,error:t}=await (0,n.xq)({url:"/api/auth/logout",method:"POST"});return!t&&(e({user:null,apiKeys:[],securityScore:0,profileCompletion:0}),!0)},hasPermission:e=>{var t;let{user:n,apiKeys:a}=r();return(null==n||null==(t=n.role)?void 0:t.name)==="Super Admin"||!!(null==n?void 0:n.role)&&(!!(n.role.permissions||[]).some(r=>"string"==typeof r?r===e:"object"==typeof r&&!!r.name&&r.name===e)||a.some(r=>r.permissions.includes(e)))},calculateSecurityScore:()=>{let{user:t}=r();e({securityScore:s(t)})},calculateProfileCompletion:()=>{let{user:t}=r();e({profileCompletion:i(t)})},updateUser:async t=>{try{let{data:a,error:s}=await (0,n.xq)({url:"/api/user/profile",method:"PUT",body:t});if(s)return e({error:s}),!1;let{user:i}=r();if(!i)return e({error:"User not logged in"}),!1;return e({user:{...i,...t},error:null}),r().calculateSecurityScore(),r().calculateProfileCompletion(),!0}catch(r){return e({error:r instanceof Error?r.message:"Failed to update user"}),!1}},updateAvatar:async t=>{try{let{data:a,error:s}=await (0,n.xq)({url:"/api/user/profile",method:"PUT",body:{avatar:t}});if(s)return e({error:s}),!1;let{user:i}=r();if(!i)return e({error:"User not logged in"}),!1;return e({user:{...i,avatar:t},error:null}),r().calculateProfileCompletion(),!0}catch(r){return e({error:r instanceof Error?r.message:"Failed to update avatar"}),!1}},fetchApiKeys:async()=>{e({apiKeyLoading:!0,apiKeyError:null});try{let{data:r,error:a}=await (0,n.xq)({url:"/api/user/api-key",silentSuccess:!0});if(a)return void e({apiKeyError:a,apiKeyLoading:!1});let s=Array.isArray(r)?r.map(t):[];e({apiKeys:s,apiKeyLoading:!1})}catch(r){e({apiKeyError:r instanceof Error?r.message:"Unknown error occurred",apiKeyLoading:!1})}},createApiKey:async(a,s,i,o)=>{if(e({apiKeyLoading:!0,apiKeyError:null}),r().apiKeys.length>=10)return void e({apiKeyError:"Cannot create more than 10 API keys",apiKeyLoading:!1});try{let{data:r,error:l}=await (0,n.xq)({url:"/api/user/api-key",method:"POST",body:{name:a,permissions:s,ipWhitelist:i,ipRestriction:o},silentSuccess:!0});if(l)return void e({apiKeyError:l,apiKeyLoading:!1});let d=t(r);return e(e=>({apiKeys:[...e.apiKeys,d],apiKeyLoading:!1})),d}catch(r){e({apiKeyError:r instanceof Error?r.message:"Unknown error occurred",apiKeyLoading:!1});return}},updateApiKey:async(r,a,s,i)=>{e({apiKeyLoading:!0,apiKeyError:null});try{let{data:o,error:l}=await (0,n.xq)({url:"/api/user/api-key/".concat(r),method:"PUT",body:{permissions:a,ipWhitelist:s,ipRestriction:i},silentSuccess:!0});if(l)return void e({apiKeyError:l,apiKeyLoading:!1});let d=t(o);return e(e=>({apiKeys:e.apiKeys.map(e=>e.id===r?d:e),apiKeyLoading:!1})),d}catch(r){e({apiKeyError:r instanceof Error?r.message:"Unknown error occurred",apiKeyLoading:!1});return}},deleteApiKey:async r=>{e({apiKeyLoading:!0,apiKeyError:null});let{error:t}=await (0,n.xq)({url:"/api/user/api-key/".concat(r),method:"DELETE",silentSuccess:!0});if(t)return void e({apiKeyError:t,apiKeyLoading:!1});e(e=>({apiKeys:e.apiKeys.filter(e=>e.id!==r),apiKeyLoading:!1}))},connectWallet:async(e,r)=>{try{let{data:t,error:a}=await (0,n.xq)({url:"/api/user/profile/wallet/connect",method:"POST",body:{address:e,chainId:r}});if(a)return console.error("Error connecting wallet:",a),!1;return!0}catch(e){return console.error("Error connecting wallet:",e),!1}},disconnectWallet:async e=>{try{let{data:r,error:t}=await (0,n.xq)({url:"/api/user/profile/wallet/disconnect",method:"POST",body:{address:e}});if(t)return console.error("Error disconnecting wallet:",t),!1;return!0}catch(e){return console.error("Error disconnecting wallet:",e),!1}},login:async(r,t)=>{e({isLoading:!0,error:null});try{let{data:a,error:s}=await (0,n.xq)({url:"/api/auth/login",method:"POST",body:{email:r,password:t},silentSuccess:!0});if(s)return e({error:s,isLoading:!1}),!1;try{let{data:r,error:t}=await (0,n.xq)({url:"/api/user/profile",method:"GET",silentSuccess:!0});if(t)return console.warn("Failed to fetch user profile after login:",t),e({isLoading:!1,error:null}),!0;if(r)return e({user:r,isLoading:!1,error:null}),!0}catch(e){console.warn("Error fetching user profile after login:",e)}return e({isLoading:!1}),!0}catch(r){return e({error:r instanceof Error?r.message:"Login failed",isLoading:!1}),!1}},register:async r=>{e({isLoading:!0,error:null});try{let{data:t,error:a}=await (0,n.xq)({url:"/api/auth/register",method:"POST",body:r});if(a)return console.log("Registration error detected:",a),e({error:a,isLoading:!1}),{success:!1,data:null,userLoggedIn:!1};if(t&&"object"==typeof t){if(t.message&&!t.cookies&&!t.user&&!t.accessToken){let r=t.message.toLowerCase(),n=["successful","success","verify your email","verification email sent","registered successfully","registration successful","created successfully","completed","sent","you have been registered successfully","you have been logged in successfully","email verified successfully","password reset successfully","email with reset instructions sent successfully","otp saved successfully","otp resent successfully","you have been logged out","user already registered but email not verified"].some(e=>r.includes(e));if(["already in use","not found","invalid","failed","error","denied","forbidden","unauthorized","expired","missing","required"].some(e=>r.includes(e))){let r=t.message;return console.log("Registration failed - error message in response:",r),e({error:r,isLoading:!1}),{success:!1,data:null,userLoggedIn:!1}}if(n)return console.log("Registration succeeded - success message in response:",t.message),e({isLoading:!1,error:null}),{success:!0,data:t,userLoggedIn:!1}}if(t.error||t.errors||!1===t.success){let r=t.error||t.message||"Registration failed";return console.log("Registration failed - error fields in response:",r),e({error:r,isLoading:!1}),{success:!1,data:null,userLoggedIn:!1}}}if(t&&t.cookies)try{let{data:r,error:a}=await (0,n.xq)({url:"/api/user/profile",method:"GET",silentSuccess:!0});if(r&&!a)return e({user:r,isLoading:!1,error:null}),{success:!0,data:t,userLoggedIn:!0}}catch(e){console.warn("Error fetching user profile after registration:",e)}return e({isLoading:!1}),{success:!0,data:t,userLoggedIn:!1}}catch(r){return e({error:r instanceof Error?r.message:"Registration failed",isLoading:!1}),{success:!1,data:null,userLoggedIn:!1}}},requestPasswordReset:async r=>{e({isLoading:!0,error:null});try{let{data:t,error:a}=await (0,n.xq)({url:"/api/auth/reset",method:"POST",body:{email:r},silentSuccess:!0});if(e({isLoading:!1}),a)return e({error:a}),!1;return!0}catch(r){return e({error:r instanceof Error?r.message:"Failed to request password reset",isLoading:!1}),!1}},verifyResetToken:async r=>{e({isLoading:!0,error:null});try{let{data:t,error:a}=await (0,n.xq)({url:"/api/auth/verify/reset",method:"POST",body:{token:r},silentSuccess:!0});if(e({isLoading:!1}),a)return e({error:a}),!1;return!0}catch(r){return e({error:r instanceof Error?r.message:"Failed to verify reset token",isLoading:!1}),!1}},resetPassword:async(r,t)=>{e({isLoading:!0,error:null});try{let{data:a,error:s}=await (0,n.xq)({url:"/api/auth/verify/reset",method:"POST",body:{token:r,newPassword:t},silentSuccess:!0});if(e({isLoading:!1}),s)return e({error:s}),!1;return!0}catch(r){return e({error:r instanceof Error?r.message:"Failed to reset password",isLoading:!1}),!1}}}})}}]);